<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8">

  <title>Провести вычисления со мобильными таблицами</title>
  <style type="text/css">

  <!-- 

  H1 {font-weight:bold; color:#006699; font-size:125%; }
  H2 {font-weight:bold; color:#006699; font-size:110%; }
  TABLE {font-size:100%;}

  /* paragraph tags */
  .step {text-indent: -1.3em; margin-left:1.3em; margin-top: 0px;}
  .menuselection {margin-left:10px}
  .bullet {list-style-type: disc;margin-top:12px; margin-left:36px; text-indent:-1em; }
  .codeblock {background-color: #ffffe6; display:block; margin-left:5px; padding:5px;}

  /* inline tags */
  .screen {font-weight:bold; color:#408080}                       /*** used refer to on-screen text ***/
  .name {font-style: italic}                                                       /*** used to tag names, such as variable names, file names, and so forth ***/
  .runinhead {font-weight: bold} 
  .superscript {vertical-align:super; font-size:80%}
  .subscript {vertical-align:sub; font-size:80%}


  --> 
  </style>
</head>

<body>
  <h1>Провести вычисления с мобильными таблицами</h1>В этой процедуре вычисляются значения на основе значений в мобильной таблице. Результаты могут заместить существующие значения в ячейках, или их можно поместить в новые строки или столбцы, если запустить версию Statistics новее версии 20. вы можете выбрать конкретные типы таблиц в средстве просмотра, к которым эти модификации будут применены, а также рамки их применения.

  <p class="bullet">•На облегченные таблицы, которые доступны в Версии 19, эта команда не действует, поскольку их нельзя редактировать.</p>

  <p>Спецификация отбора состоит из следующих элементов:</p>

  <ul>
    <li>Типы таблиц для обработки. Типы являются OMS -подтипами таблиц.</li>

    <li>Измерение: куда будут направляться результаты, в строки или в столбцы (по умолчанию в столбцы).</li>

    <li>Конкретные строки или столбцы назначения</li>

    <li>Область применения прикладной программы: только от предшествующей команды или весь вывод (по умолчанию - предшествующий вывод).</li>
  </ul>

  <h2>Отбор таблиц, измерения, а также строк или столбцов назначения</h2>

  <p><span class="runinhead">Подтип таблицы:</span> Введите OMS-подтип таблицы. Подтип можно найти, щелкнув правой кнопкой мыши в схеме на экземпляре таблицы и выбирая <em>Копировать OMS-подтип</em> из списка в <em>Утилиты&gt;OMS-идентификаторы</em>. Введите *, чтобы выбрать все подтипы (редко бывает полезно для этой команды).</p>

  <p class="bullet">• Эта команда не может обрабатывать определенные типы таблиц. Нельзя обрабатывать таблицы со слоями, у которых есть несколько категорий или несколько измерений. Таблицы с истинным вложением в выбранном измерении обрабатывать нельзя, кроме режима замещения. Обратите внимание, что вывод пользовательских таблиц, которые могут оказаться вложенными, фактически не использует истинного вложения, то есть их можно обрабатывать.</p>

  <p><span class="runinhead">Измерение:</span> Выберите <i>Столбцы</i> или <i>Строки</i>, чтобы задать измерение таблицы для обработки. Если выбрано Столбцы, новое значение вычисляется для каждой строки в таблице и помещается в выбранный столбец этой строки. Если выбрано Строки, новое значение вычисляется для каждого столбца в таблице и помещается в выбранную строку этого столбца. Можно задать несколько строк или столбцов вывода.</p>

  <p><span class="runinhead">Столбцы или строки назначения</span> Введите через пробелы список строк или столбцов для обработки.
  Строки или столбцы могут быть заданы с помощью номеров позиций, отсчитываемых с нуля, или текста меток в кавычках. При задании текстом первая совпадающая метка определяет положение назначения.</p>

  <p class="bullet">• Текстовые совпадения зависят от регистра.</p>

  <p><span class="runinhead">Повторить целевые спецификации для всего измерения</span> Если одинаковая метка может встретиться несколько раз, можно включить этот переключатель для повторения этой метки или последовательности меток столько раз, сколько нужно для покрытия всего измерения. Например, в таблице может быть метка "Количество" для каждой категории переменной.
  Если включить этот переключатель, назначение "Количество" будет повторено для каждой категории.</p>

  <p class="bullet">• Повторение можно использовать только в тех случаях, когда объекты назначения заданы как метки, а не как числа.</p>

  <p><span class="runinhead">Уровень совпадения текста меток</span>
  Номер первой (крайней) строки или крайнего столбца - это 0. Используйте отрицательные числа для обратного отсчета с конца: -1 соответствует последней (внутренней) строке или последнему столбцу. Числовые и текстовые спецификации можно объединять.</p>

  <p class="bullet">• Строки и столбцы считаются, начиная с самого дальнего внутреннего уровня таблицы.</p>

  <p><span class="runinhead">Обрабатывать все или последние таблицы</span> Выберите, обрабатывать ли таблицы только от самого последнего вывода команды, или все таблицы заданного типа в программе просмотра.</p>

  <p><span class="runinhead">Печатать метки таблицы (для отладки)</span> Включите этот переключатель, чтобы увидеть все метки в выбранном измерении. Так как многие таблицы имеют скрытые метки, пользуйтесь этой возможностью, чтобы увидеть структуру целиком.</p>

  <p><span class="runinhead">Формула;</span> Формула задает, какие вычисления нужно выполнить. При помещении результата в столбец она применяется к каждой строке, и наоборот. Если используется ссылка на элементы в кавычках, используйте одинарные кавычки ('), а не двойные (").</p>

  <p>Формула может использовать стандартные арифметические операторы (две звездочки ** для возведения в степень) и стандартные математические функции Python, такие как min, max, mod, trunc, round, abs, exp и log (натуральный логарифм, используйте log(x,10) для десятичного логарифма). Это должен быть допустимый синтаксис Python, исключения объясняются ниже. Полный список операций смотрите в документации Python, в том числе по модулю math.</p>

  <p>На значения строк или столбцов в таблице можно ссылаться тремя способами. Все это должно быть определено ДО включения любых элементов в таблицы.</p>

  <ul>
    <li>Ссылки по форме xn, где n - это целое число, например, x2, на конкретный столбец или строку. Нумерация начинается с нуля, то есть x0 - это или первая строка, или первый столбец.</li>

    <li>Ссылки вида x[n] или x[-n] указывают на значения слева или справа (сверху или снизу) от положения назначения. Например, x[-1] ссылается на положение непосредственно слева для столбцов или непосредственно сверху для строк.
    x[1] - это положение непосредственно справа. x[0] - это само положение назначения (до того, как назначение вставлено).

      <p>Пример: допустим, есть столбцы с метками a, b и c, а положение назначения - это c.
Тогда x[0] ссылается на значение c, x[-1] ссылается на b, а x[-2] - на a, независимо от установки режима.</p>
    </li>

    <li>Ссылки вида x['строка'] или x[-'строка'] указывают на значения слева или справа (сверху или снизу) от положения назначения, где строка - это значение метки на заданной уровне. Например, x[-'Clerical'] ссылается на ближайший столбец слева от положения назначения, который помечен как "Clerical".

      <p>Обратите внимание на то, что строки должны быть заключены в кавычки. Обозначения скобок, используемые здесь, НЕ относятся к словарям Python, а используются для указания положений.</p>
    </li>
  </ul>

  <p><span class="runinhead">Модуль с пользовательскими функциями для использования в формуле</span> Стандартная запись формулы только предоставляет доступ к значениям в той же строке или в том же столбце, где находится результат. Чтобы обратиться к другим значениям в таблице, например, к итоговым значениям снизу, нужно написать пользовательскую функцию. Это может быть полезно также при сложных вычислениях.
  Задайте имя модуля Python, содержащего одну или несколько функций, которые будут использоваться в формуле. Смотрите ниже подробности, как писать пользовательскую функцию.</p>

  <p><span class="runinhead">Скрыть входные столбцы или строки</span>
Включите этот переключатель, чтобы скрыть все входные строки или столбцы, на которые ссылается формула (кроме ссылок в пользовательской функции).</p>

  <p><span class="runinhead">Ширина столбцов назначения (в пунктах)</span>
Введите число, чтобы задать ширину столбцов назначения. Количество относится к пунктам. 72 пункта - это один дюйм.</p>

  <p><span class="runinhead">Формат столбцов назначения</span> Выберите формат для столбцов назначения. ASIS использует текущий формат, если режим назначения - это замещение; в противном случае используется значение по умолчанию. Другие перечисленные форматы те же, что показаны в диалоговом окне Форматы ячеек в редакторе мобильной таблицы. Форматы даты здесь не перечислены, но они также допустимы в синтаксисе.</p>

  <p><span class="runinhead">Число десятичных знаков</span>
Задает количество знаков для вывода после запятой.
  Эта установка неприменима, если выбран формат ASIS.</p>

  <p><span class="runinhead">Показывать недопустимые значения как</span>
Если значение нельзя вычислить, так как входные данные недопустимы, например, отсутствующее или нечисловое значение или деление на ноль, этот параметр управляет тем, что именно будет показано в таблице. Если включена последняя радиокнопка, можно ввести пользовательский текст.</p>

  <h2>Использование пользовательского модуля в формуле</h2>У пользовательского модуля может быть доступ ко всей мобильной таблице. Приведен пример, когда суммарная информация таблицы сопряженности используется в вычислениях для каждой строки.

  <p class="codeblock">CROSSTABS /TABLES=jobcat BY gender
  /CELLS=COUNT.</p>

  <p>Эта команда использует пользовательскую функцию для обращения к итоговым значениям в таблице.</p>

  <p class="codeblock">stats table calc
  subtype='Crosstabulation'<br>
  /target dimension=columns level=-1 location="Total" Mode=replace
  label="Ratio"<br>
  &nbsp;&nbsp;custommodule="customexample"<br>
  &nbsp;&nbsp;formula = "customexample.custom(datacells, ncells,
  datacells.GetValueAt(roworcol, 0))"<br>
  &nbsp;&nbsp;/format cellformat="#,###.##" decimals=3.<br></p>

  <p>Это функция из модуля customexample:</p>

  <p class="codeblock">def custom(datacells, ncells, value):<br>
  &nbsp;&nbsp;'''Вычислить процент от итога'''<br>
  &nbsp;&nbsp;x =
  float(datacells.GetUnformattedValueAt(ncells-1,2)) # итог<br>
  &nbsp;&nbsp;return float(value) / x<br></p>

  <p>Примечание: Для использования в формуле доступны следующие переменные в дополнение к входным параметрам и содержимому заданного пользовательского модуля.</p>

  <ul>
    <li>pt - объект мобильной таблицы (pivot table)</li>

    <li>datacells - объект ячеек данных мобильной таблицы</li>

    <li>labels - объект меток строки или столбца, соответствующий параметру DIMENSION</li>

    <li>ncells - количество строк или столбцов в объекте datacells. Например, если DIMENSION - это столбец, ncells - это число строк.</li>

    <li>roworcol - текущая строка или текущий столбец в таблице.</li>

    <li>customdict - словарь, который может использовать пользовательская функция для хранения элементов по вызовам. Изначально он содержит две записи.
    Они предназначены исключительно для использования пользовательской функцией и не оказывают влияния на действие данной команды.

      <ul>
        <li>firstload - True.</li>

        <li>firsttable - задать значение True всякий раз, когда вычисляется новая таблица. Чтобы в необходимых случаях задать значение False, нужно создать пользовательский код</li>
      </ul>
    </li>
  </ul>
  <p>Метод GetUnformattedValueAt возвращает строку Unicode. Она должна быть преобразована в числовой формат с плавающей запятой для проведения вычислений.</p>
      <h2>Дополнительные возможности</h2>

      <p>Это диалоговое окно генерирует синтаксис для команды расширения STATS TABLE CALC. Чтобы вывести справку для этой команды, введите следующую команду:</p>

      <p class="codeblock">STATS TABLE CALC /HELP.</p>С помощью синтаксиса команд можно задать список подтипов, выводимых по отдельности.

      <p>В синтаксисе можно ссылаться на связанную вторичную таблицу и вставлять или использовать ее значения в вычислениях.</p>

      <h2>Технические требования</h2>

      <p>Это диалоговое окно требует надстройку интеграции для Python и команду расширения STATS TABLE CALC. Дополнительные сведения смотрите в разделе How to Get Integration Plug-Ins (Получение подключаемых модулей интеграции).
Этот раздел находится в системе справки IBM SPSS Statistics: Core System &gt; Frequently Asked Questions (Основная система &gt; Часто задаваемые вопросы). Эта команда распространяется как пакет расширений.</p><br>
      <hr>

      <p style="font-size:80%;">© Copyright SPSS Inc. 1989,
      2013</p>
</body>
</html>
